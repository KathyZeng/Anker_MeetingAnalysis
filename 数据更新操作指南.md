# 会议改善效果评估仪表盘 - 数据更新操作指南

生成时间: 2025-11-20

---

## 📋 目录

1. [快速开始](#快速开始)
2. [数据文件格式要求](#数据文件格式要求)
3. [新增数据步骤](#新增数据步骤)
4. [数据文件命名规范](#数据文件命名规范)
5. [完整示例](#完整示例)
6. [常见问题](#常见问题)
7. [技术说明](#技术说明)

---

## 🚀 快速开始

### 最简单的更新流程（3步）

```bash
# 步骤1: 将新的CSV文件放入input目录
cp 11月会议详情.csv input/

# 步骤2: 运行生成脚本
python3 generate_full_dashboard.py

# 步骤3: 打开查看
open output/meeting_dashboard_full.html
```

**就这么简单！** 页面样式和格式完全保持不变，只更新数据内容。

---

## 📊 数据文件格式要求

### 必需的列（CSV表头）

新增的CSV文件必须包含以下列名（顺序不限）：

| 列名 | 说明 | 示例值 |
|------|------|--------|
| `user_name` | 用户姓名 | 张三 |
| `period_name` | 周期名称（可选） | 11月 |
| `日人均线上会议数` | 每天平均会议次数 | 3.5 |
| `日人均线上会议时长(分钟)` | 每天平均会议时长 | 65.3 |
| `即时会议` | 即时会议数量 | 12 |
| `日程会议` | 日程会议数量 | 18 |
| `1v1通话数` | 1对1通话数量 | 8 |

### 可选列

以下列可以包含，但不是必需的：

- `人的会议数`
- `即时+日程会议`
- `日人均线上会议数-即时+日程`
- `日人均线上会议时长(分钟)-即时+日程`

### CSV文件示例

```csv
user_name,人的会议数,即时+日程会议,日程会议,即时会议,1v1通话数,日人均线上会议数,日人均线上会议数-即时+日程,日人均线上会议时长(分钟),日人均线上会议时长(分钟)-即时+日程
张三,35,30,18,12,8,3.5,3.0,65.3,58.2
李四,42,35,22,13,10,4.2,3.5,82.1,72.5
王五,28,25,15,10,5,2.8,2.5,48.3,42.1
```

---

## 📥 新增数据步骤

### 示例：新增11月会议详情

#### 步骤1: 准备CSV文件

确保你的CSV文件：
- ✅ 包含所有必需的列
- ✅ 使用UTF-8编码
- ✅ 数据格式正确（数字为纯数字，无特殊字符）
- ✅ 文件命名清晰（建议：`11月会议详情.csv` 或 `11.17-11.23会议详情.csv`）

#### 步骤2: 放入input目录

```bash
# 方法1: 使用命令行
cp /path/to/11月会议详情.csv input/

# 方法2: 直接拖拽
# 在Finder中将CSV文件拖到 input 文件夹
```

#### 步骤3: 验证文件

```bash
# 查看input目录下的所有CSV文件
ls input/*.csv

# 示例输出：
# input/9月会议详情.csv
# input/10月会议详情.csv
# input/10.20-10.26会议详情.csv
# input/10.27-11.2会议详情.csv
# input/11.03-11.09会议详情.csv
# input/11.10-11.16会议详情.csv
# input/11月会议详情.csv  ← 新增的文件
```

#### 步骤4: 运行生成脚本

```bash
python3 generate_full_dashboard.py
```

**输出示例：**
```
======================================================================
        会议改善效果评估 - 完整交互式仪表盘生成器
======================================================================

[1/4] 加载数据...
📂 找到 7 个CSV文件
   ✓ 11.10-11.16会议详情.csv: 41 条记录
   ✓ 10.20-10.26会议详情.csv: 39 条记录
   ✓ 10.27-11.2会议详情.csv: 44 条记录
   ✓ 9月会议详情.csv: 47 条记录
   ✓ 10月会议详情.csv: 50 条记录
   ✓ 11.03-11.09会议详情.csv: 43 条记录
   ✓ 11月会议详情.csv: 45 条记录  ← 新增的数据

✅ 数据加载完成: 总计 309 条记录
   ✓ 已加载 309 条记录
   ✓ 基线期: 97 条
   ✓ 当前期: 212 条

[2/4] 准备分析数据...
   ✓ KPI指标: 3 组
   ✓ Top10用户: 10 人
   ✓ 异常检测: 8 个
   ✓ 原始数据: 309 条
   ✓ 周期对比: 7 个周期

[3/4] 生成完整HTML仪表盘...
   ✓ 仪表盘生成成功

[4/4] 生成数据统计...
   ✓ KPI达标情况: 0/3
   ✓ 高频用户: 11 人
   ✓ 中频用户: 28 人
   ✓ 低频用户: 12 人

======================================================================
✅ 完整仪表盘生成完成!
======================================================================

📄 文件位置: output/meeting_dashboard_full.html
🌐 打开方式: open output/meeting_dashboard_full.html
📊 包含模块: 概览页面 | 原始数据 | 分析结果 | 人员详情

======================================================================
```

#### 步骤5: 查看更新后的仪表盘

```bash
open output/meeting_dashboard_full.html
```

---

## 📝 数据文件命名规范

### 推荐命名格式

#### 格式1: 月度数据
```
[月份]月会议详情.csv
```
**示例：**
- `9月会议详情.csv`
- `10月会议详情.csv`
- `11月会议详情.csv`
- `12月会议详情.csv`

#### 格式2: 周度数据
```
[开始日期]-[结束日期]会议详情.csv
```
**示例：**
- `10.20-10.26会议详情.csv`
- `10.27-11.2会议详情.csv`
- `11.03-11.09会议详情.csv`
- `11.10-11.16会议详情.csv`
- `11.17-11.23会议详情.csv`

#### 格式3: 自定义周期
```
[周期名称]会议详情.csv
```
**示例：**
- `第一季度会议详情.csv`
- `2025上半年会议详情.csv`
- `项目冲刺期会议详情.csv`

### 命名注意事项

✅ **推荐做法：**
- 使用中文命名，清晰易读
- 包含明确的时间信息
- 使用统一的命名模式

❌ **避免使用：**
- 特殊字符（如：/ \ : * ? " < > |）
- 空格（建议用下划线或连字符代替）
- 过长的文件名（建议30个字符以内）

---

## 💡 完整示例

### 场景：新增2025年11月17-23日的周度数据

#### 1. 准备数据文件

文件名：`11.17-11.23会议详情.csv`

内容示例：
```csv
user_name,人的会议数,即时+日程会议,日程会议,即时会议,1v1通话数,日人均线上会议数,日人均线上会议数-即时+日程,日人均线上会议时长(分钟),日人均线上会议时长(分钟)-即时+日程
张三,38,32,20,12,9,3.8,3.2,72.5,65.3
李四,45,38,24,14,11,4.5,3.8,88.2,78.5
王五,30,26,16,10,6,3.0,2.6,52.3,46.1
赵六,42,35,22,13,10,4.2,3.5,79.8,70.2
孙七,28,24,15,9,7,2.8,2.4,48.6,42.3
```

#### 2. 放入input目录

```bash
# 假设文件在桌面
cp ~/Desktop/11.17-11.23会议详情.csv input/
```

#### 3. 验证文件内容

```bash
# 查看文件前5行
head -5 input/11.17-11.23会议详情.csv

# 检查列名是否正确
head -1 input/11.17-11.23会议详情.csv
```

#### 4. 生成仪表盘

```bash
python3 generate_full_dashboard.py
```

#### 5. 验证结果

打开仪表盘后，检查以下内容：

✅ **概览页面：**
- KPI卡片显示最新数据
- 趋势分析包含新周期
- 会议类型分布更新

✅ **原始数据页面：**
- 时间段筛选下拉框包含新周期
- 数据表格包含新记录
- 总记录数增加

✅ **分析结果页面：**
- KPI详细分析反映新数据
- 描述性统计更新
- 会议类型分布包含新数据

✅ **人员详情页面：**
- Top10用户列表更新
- 人员分层统计变化
- 异常检测包含新数据

---

## 🔧 常见问题

### Q1: 新增数据后，仪表盘没有变化？

**A: 请检查以下几点：**

1. 确认CSV文件已放入 `input/` 目录
   ```bash
   ls input/*.csv
   ```

2. 确认已重新运行生成脚本
   ```bash
   python3 generate_full_dashboard.py
   ```

3. 刷新浏览器（按 `Cmd + R` 或 `F5`）

4. 清除浏览器缓存后重新打开

### Q2: 提示"列不存在"错误？

**A: 检查CSV文件的列名是否正确**

```bash
# 查看CSV文件的表头
head -1 input/你的文件.csv
```

必需的列名：
- `user_name`
- `日人均线上会议数`
- `日人均线上会议时长(分钟)`
- `即时会议`
- `日程会议`
- `1v1通话数`

### Q3: 数据显示乱码？

**A: 确保CSV文件使用UTF-8编码**

```bash
# 在Mac上转换编码
iconv -f GBK -t UTF-8 原文件.csv > 新文件.csv

# 或使用Numbers/Excel另存为UTF-8编码
```

### Q4: 如何删除旧数据？

**A: 直接从input目录删除对应的CSV文件**

```bash
# 删除指定文件
rm input/旧文件.csv

# 重新生成仪表盘
python3 generate_full_dashboard.py
```

### Q5: 想修改某个周期的数据？

**A: 直接编辑对应的CSV文件**

```bash
# 用Excel或Numbers打开编辑
open input/需要修改的文件.csv

# 保存后重新生成
python3 generate_full_dashboard.py
```

### Q6: 如何只看最近几个周期的数据？

**A: 方法1 - 临时移出旧数据**

```bash
# 创建临时存档目录
mkdir input/archive

# 移动旧数据
mv input/9月会议详情.csv input/archive/
mv input/10月会议详情.csv input/archive/

# 重新生成
python3 generate_full_dashboard.py

# 需要时可以移回来
mv input/archive/*.csv input/
```

**方法2 - 使用仪表盘的筛选功能**
- 在"原始数据"页面使用时间段筛选
- 选择需要的周期
- 导出筛选后的数据

### Q7: 数据太多，加载变慢？

**A: 考虑以下优化方案：**

1. **按季度归档**：将旧数据移到archive目录
2. **数据抽样**：对历史数据进行抽样保留
3. **分阶段分析**：为不同时期生成独立的仪表盘

---

## 🔬 技术说明

### 数据加载机制

系统会自动：

1. **扫描input目录**：读取所有 `.csv` 文件
2. **合并数据**：将所有CSV文件的数据合并
3. **周期识别**：自动识别数据周期（基于文件名或period_name列）
4. **数据清洗**：处理缺失值、异常值
5. **计算分析**：
   - 基线期：识别为"9月"和"10月"的数据
   - 当前期：最近4周的数据
   - KPI计算：基于基线期和当前期的对比

### 基线期和当前期的定义

**基线期（Baseline）：**
- 包含：文件名或周期名包含"9月"或"10月"的数据
- 用途：作为改善效果的对比基准

**当前期（Current）：**
- 包含：最近4周的数据
- 识别逻辑：按时间倒序排序，取最近4个周期
- 用途：评估当前的会议状况

### 自定义周期定义

如果需要修改基线期和当前期的定义，可以编辑：

```python
# meeting_analysis/data_loader.py

def get_baseline_data(self) -> pd.DataFrame:
    """获取基线期数据（9月和10月）"""
    # 修改这里的逻辑来自定义基线期
    ...

def get_recent_weeks_data(self, weeks: int = 4) -> pd.DataFrame:
    """获取最近N周的数据作为当前期"""
    # 修改 weeks 参数来调整当前期的周数
    ...
```

### 数据处理流程

```
CSV文件
  ↓
[数据加载] (data_loader.py)
  ↓
[指标计算] (calculator.py)
  ↓
[数据分析] (analyzer.py)
  ↓
[数据准备] (dashboard_generator.py)
  ↓
[HTML生成] (full_dashboard_gen.py)
  ↓
仪表盘文件 (meeting_dashboard_full.html)
```

### 文件结构

```
regular/
├── input/                          # 📥 数据输入目录
│   ├── 9月会议详情.csv            # 基线期数据
│   ├── 10月会议详情.csv           # 基线期数据
│   ├── 10.20-10.26会议详情.csv    # 周度数据
│   ├── 10.27-11.2会议详情.csv     # 周度数据
│   ├── 11.03-11.09会议详情.csv    # 周度数据
│   ├── 11.10-11.16会议详情.csv    # 周度数据
│   └── 11月会议详情.csv           # 🆕 新增数据
│
├── meeting_analysis/               # 核心处理模块
│   ├── data_loader.py             # 数据加载
│   ├── calculator.py              # KPI计算
│   ├── analyzer.py                # 数据分析
│   ├── dashboard_generator.py     # 数据准备
│   └── full_dashboard_gen.py      # HTML生成
│
├── output/                         # 📤 输出目录
│   └── meeting_dashboard_full.html # 生成的仪表盘
│
├── generate_full_dashboard.py      # 🚀 主生成脚本
└── 数据更新操作指南.md             # 📖 本文档
```

---

## 📋 快速检查清单

在添加新数据前，请确认：

- [ ] CSV文件包含所有必需的列
- [ ] 文件使用UTF-8编码
- [ ] 数据格式正确（数字列为纯数字）
- [ ] 文件名清晰易读
- [ ] 文件已放入 `input/` 目录
- [ ] 运行了 `python3 generate_full_dashboard.py`
- [ ] 刷新浏览器查看新仪表盘

---

## 🎯 最佳实践

### 1. 定期备份

```bash
# 每次更新前备份
cp -r input/ input_backup_$(date +%Y%m%d)/
cp output/meeting_dashboard_full.html output/backup/dashboard_$(date +%Y%m%d).html
```

### 2. 版本管理

```bash
# 使用git管理数据文件
git add input/*.csv
git commit -m "添加11月会议数据"
git push
```

### 3. 数据验证

```bash
# 检查CSV文件格式
python3 -c "
import pandas as pd
df = pd.read_csv('input/11月会议详情.csv')
print('列名:', list(df.columns))
print('记录数:', len(df))
print('前3行:')
print(df.head(3))
"
```

### 4. 自动化更新

创建自动化脚本 `auto_update.sh`：

```bash
#!/bin/bash
# 自动化更新脚本

echo "🔄 开始更新仪表盘..."

# 检查是否有新文件
NEW_FILES=$(find input -name "*.csv" -mtime -1)
if [ -z "$NEW_FILES" ]; then
    echo "⚠️  未发现新数据文件"
    exit 0
fi

echo "📂 发现新文件:"
echo "$NEW_FILES"

# 生成仪表盘
python3 generate_full_dashboard.py

# 备份
cp output/meeting_dashboard_full.html output/backup/dashboard_$(date +%Y%m%d_%H%M%S).html

echo "✅ 更新完成!"
echo "📄 文件位置: output/meeting_dashboard_full.html"
```

使用方法：
```bash
chmod +x auto_update.sh
./auto_update.sh
```

---

## 📞 获取帮助

如遇到问题，请参考：

1. **项目文档**
   - `README.md` - 项目总览
   - `使用指南.md` - 详细使用说明
   - `仪表盘使用说明.md` - 仪表盘功能说明

2. **检查日志**
   ```bash
   python3 generate_full_dashboard.py 2>&1 | tee update.log
   ```

3. **数据验证**
   ```bash
   # 查看数据加载情况
   python3 -c "
   from meeting_analysis.data_loader import MeetingDataLoader
   loader = MeetingDataLoader('input')
   data = loader.load_all_data()
   print(f'总记录数: {len(data)}')
   print(f'周期列表: {data[\"周期\"].unique()}')
   "
   ```

---

**最后更新**: 2025-11-20
**版本**: v1.0
**状态**: ✅ 生产就绪
