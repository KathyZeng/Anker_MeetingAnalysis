# ä¼šè®®æ”¹å–„æ•ˆæœåˆ†æç³»ç»Ÿ V2.0 - ç®€åŒ–æŠ€æœ¯æ–¹æ¡ˆ

**åˆ›å»ºæ—¶é—´**: 2025-11-20
**ç‰ˆæœ¬**: V2.0 ç®€åŒ–æ–¹æ¡ˆï¼ˆåŸºäºæ–‡ä»¶ç³»ç»Ÿï¼‰
**çŠ¶æ€**: å¾…ç¡®è®¤

---

## ğŸ¯ æ ¸å¿ƒç†å¿µï¼šæç®€è®¾è®¡

**è®¾è®¡åŸåˆ™**:
- âœ… ä¸ä½¿ç”¨æ•°æ®åº“ï¼Œçº¯æ–‡ä»¶ç³»ç»Ÿ
- âœ… ä¸€ä¸ªWebç•Œé¢è¾“å…¥å’Œå±•ç¤º
- âœ… ä¿æŒV1çš„æ ·å¼å’ŒåŠŸèƒ½
- âœ… æ”¯æŒå‘¨åº¦æ•°æ®ç®¡ç†
- âœ… æœ¬åœ°Gitç‰ˆæœ¬æ§åˆ¶

---

## ğŸ“ V2.0 ç®€åŒ–é¡¹ç›®ç»“æ„

```
meeting-analysis-v2/
â”‚
â”œâ”€â”€ ğŸ“ app/                              # åº”ç”¨æ ¸å¿ƒ
â”‚   â”œâ”€â”€ ğŸ“„ __init__.py                   # Flaskåˆå§‹åŒ–
â”‚   â”œâ”€â”€ ğŸ“„ routes.py                     # æ‰€æœ‰è·¯ç”±ï¼ˆå•æ–‡ä»¶ï¼‰
â”‚   â”œâ”€â”€ ğŸ“„ file_manager.py               # æ–‡ä»¶ç®¡ç†ï¼ˆè¯»å†™CSVï¼‰
â”‚   â”œâ”€â”€ ğŸ“„ analysis.py                   # åˆ†æé€»è¾‘ï¼ˆå¤ç”¨V1ï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ static/                       # é™æ€èµ„æº
â”‚   â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â”‚   â””â”€â”€ main.css                 # ç»Ÿä¸€æ ·å¼ï¼ˆç»§æ‰¿V1ï¼‰
â”‚   â”‚   â”œâ”€â”€ js/
â”‚   â”‚   â”‚   â”œâ”€â”€ upload.js                # ä¸Šä¼ åŠŸèƒ½
â”‚   â”‚   â”‚   â””â”€â”€ dashboard.js             # ä»ªè¡¨ç›˜ï¼ˆå¤ç”¨V1é€»è¾‘ï¼‰
â”‚   â”‚   â””â”€â”€ lib/
â”‚   â”‚       â””â”€â”€ echarts.min.js
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“ templates/                    # HTMLæ¨¡æ¿
â”‚       â”œâ”€â”€ base.html                    # åŸºç¡€æ¨¡æ¿
â”‚       â””â”€â”€ index.html                   # å•é¡µé¢åº”ç”¨ï¼ˆä¸Šä¼ +å±•ç¤ºï¼‰
â”‚
â”œâ”€â”€ ğŸ“ data/                             # æ•°æ®å­˜å‚¨ï¼ˆæ–‡ä»¶ç³»ç»Ÿï¼‰
â”‚   â”œâ”€â”€ ğŸ“ weekly_data/                  # å‘¨åº¦æ•°æ®ï¼ˆæŒ‰å‘¨ç»„ç»‡ï¼‰
â”‚   â”‚   â”œâ”€â”€ 2025-09-01_to_2025-09-07/
â”‚   â”‚   â”‚   â””â”€â”€ meeting_data.csv
â”‚   â”‚   â”œâ”€â”€ 2025-11-03_to_2025-11-09/
â”‚   â”‚   â”‚   â””â”€â”€ meeting_data.csv
â”‚   â”‚   â””â”€â”€ 2025-11-10_to_2025-11-16/
â”‚   â”‚       â””â”€â”€ meeting_data.csv
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“„ weeks_index.json              # å‘¨æœŸç´¢å¼•æ–‡ä»¶
â”‚       {
â”‚         "weeks": [
â”‚           {
â”‚             "id": "2025-11-03_to_2025-11-09",
â”‚             "start": "2025-11-03",
â”‚             "end": "2025-11-09",
â”‚             "record_count": 264,
â”‚             "uploaded_at": "2025-11-20 10:30:00"
â”‚           }
â”‚         ]
â”‚       }
â”‚
â”œâ”€â”€ ğŸ“ backups/                          # è‡ªåŠ¨å¤‡ä»½
â”‚   â””â”€â”€ 2025-11-20_100000.tar.gz
â”‚
â”œâ”€â”€ ğŸ“ logs/
â”‚   â””â”€â”€ app.log
â”‚
â”œâ”€â”€ ğŸ“„ run.py                            # å¯åŠ¨è„šæœ¬
â”œâ”€â”€ ğŸ“„ config.yaml                       # é…ç½®æ–‡ä»¶
â”œâ”€â”€ ğŸ“„ requirements.txt
â”œâ”€â”€ ğŸ“„ .gitignore
â””â”€â”€ ğŸ“„ README.md
```

---

## ğŸ”§ æ ¸å¿ƒæŠ€æœ¯å®ç°

### 1. æ•°æ®å­˜å‚¨æ–¹æ¡ˆï¼ˆæ–‡ä»¶ç³»ç»Ÿï¼‰

**ç›®å½•ç»“æ„**:
```
data/weekly_data/
  â”œâ”€â”€ 2025-11-03_to_2025-11-09/
  â”‚   â””â”€â”€ meeting_data.csv          # åŸå§‹CSV
  â”œâ”€â”€ 2025-11-10_to_2025-11-16/
  â”‚   â””â”€â”€ meeting_data.csv
  â””â”€â”€ ...

data/weeks_index.json                # è½»é‡çº§ç´¢å¼•
```

**weeks_index.json**ï¼ˆæ›¿ä»£æ•°æ®åº“ï¼‰:
```json
{
  "weeks": [
    {
      "id": "2025-11-03_to_2025-11-09",
      "display_name": "2025å¹´11æœˆç¬¬1å‘¨ (11.03-11.09)",
      "start_date": "2025-11-03",
      "end_date": "2025-11-09",
      "file_path": "data/weekly_data/2025-11-03_to_2025-11-09/meeting_data.csv",
      "record_count": 264,
      "uploaded_at": "2025-11-20 10:30:00",
      "file_size": 52480,
      "status": "active"
    }
  ],
  "baseline": {
    "type": "first_month",
    "weeks": ["2025-09-01_to_2025-09-07", "2025-09-08_to_2025-09-14"]
  }
}
```

**ä¼˜åŠ¿**:
- âœ… æ— éœ€æ•°æ®åº“ï¼Œçº¯JSONç®¡ç†å…ƒæ•°æ®
- âœ… æ•°æ®æŒ‰å‘¨åˆ†æ–‡ä»¶å¤¹ï¼Œç»“æ„æ¸…æ™°
- âœ… åŸå§‹CSVå®Œæ•´ä¿ç•™ï¼Œå¯ç›´æ¥æ‰“å¼€æŸ¥çœ‹
- âœ… Gitå‹å¥½ï¼ˆæ–‡æœ¬æ–‡ä»¶æ˜“äºç‰ˆæœ¬æ§åˆ¶ï¼‰

---

### 2. æ–‡ä»¶ç®¡ç†æ¨¡å—

```python
# app/file_manager.py
import os
import json
import pandas as pd
from datetime import datetime
from pathlib import Path

class WeeklyDataManager:
    """å‘¨åº¦æ•°æ®æ–‡ä»¶ç®¡ç†å™¨"""

    def __init__(self, data_dir="data/weekly_data"):
        self.data_dir = Path(data_dir)
        self.index_file = Path("data/weeks_index.json")
        self._ensure_dirs()

    def _ensure_dirs(self):
        """ç¡®ä¿ç›®å½•å­˜åœ¨"""
        self.data_dir.mkdir(parents=True, exist_ok=True)

    def load_index(self):
        """åŠ è½½å‘¨æœŸç´¢å¼•"""
        if self.index_file.exists():
            with open(self.index_file, 'r', encoding='utf-8') as f:
                return json.load(f)
        return {"weeks": [], "baseline": {}}

    def save_index(self, index):
        """ä¿å­˜å‘¨æœŸç´¢å¼•"""
        with open(self.index_file, 'w', encoding='utf-8') as f:
            json.dump(index, f, ensure_ascii=False, indent=2)

    def upload_csv(self, file, week_start, week_end):
        """ä¸Šä¼ CSVæ–‡ä»¶"""
        # åˆ›å»ºå‘¨æœŸç›®å½•
        week_id = f"{week_start}_to_{week_end}"
        week_dir = self.data_dir / week_id
        week_dir.mkdir(exist_ok=True)

        # ä¿å­˜CSV
        csv_path = week_dir / "meeting_data.csv"
        file.save(str(csv_path))

        # è¯»å–æ•°æ®éªŒè¯
        df = pd.read_csv(csv_path, encoding='utf-8')
        record_count = len(df)

        # æ›´æ–°ç´¢å¼•
        index = self.load_index()
        week_info = {
            "id": week_id,
            "display_name": f"{week_start} ~ {week_end}",
            "start_date": week_start,
            "end_date": week_end,
            "file_path": str(csv_path),
            "record_count": record_count,
            "uploaded_at": datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
            "file_size": os.path.getsize(csv_path),
            "status": "active"
        }

        # å»é‡ï¼šå¦‚æœå·²å­˜åœ¨åˆ™æ›´æ–°
        index["weeks"] = [w for w in index["weeks"] if w["id"] != week_id]
        index["weeks"].append(week_info)
        index["weeks"].sort(key=lambda x: x["start_date"])

        self.save_index(index)

        return week_info

    def get_week_data(self, week_id):
        """è·å–æŒ‡å®šå‘¨çš„æ•°æ®"""
        index = self.load_index()
        week = next((w for w in index["weeks"] if w["id"] == week_id), None)
        if not week:
            return None

        df = pd.read_csv(week["file_path"], encoding='utf-8')
        return df

    def get_all_weeks(self):
        """è·å–æ‰€æœ‰å‘¨æœŸåˆ—è¡¨"""
        index = self.load_index()
        return index["weeks"]

    def delete_week(self, week_id):
        """åˆ é™¤æŒ‡å®šå‘¨æ•°æ®"""
        index = self.load_index()
        week = next((w for w in index["weeks"] if w["id"] == week_id), None)
        if not week:
            return False

        # åˆ é™¤æ–‡ä»¶å¤¹
        week_dir = Path(week["file_path"]).parent
        if week_dir.exists():
            import shutil
            shutil.rmtree(week_dir)

        # æ›´æ–°ç´¢å¼•
        index["weeks"] = [w for w in index["weeks"] if w["id"] != week_id]
        self.save_index(index)

        return True
```

---

### 3. å•é¡µé¢åº”ç”¨è®¾è®¡

**é¡µé¢å¸ƒå±€**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“Š ä¼šè®®æ”¹å–„æ•ˆæœè¯„ä¼°ç³»ç»Ÿ V2.0                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ“¤ æ•°æ®ä¸Šä¼ åŒº                                          â”‚ â”‚
â”‚  â”‚                                                       â”‚ â”‚
â”‚  â”‚  [é€‰æ‹©CSVæ–‡ä»¶] [ä¸Šä¼ ] æˆ– æ‹–æ‹½æ–‡ä»¶åˆ°è¿™é‡Œ                â”‚ â”‚
â”‚  â”‚                                                       â”‚ â”‚
â”‚  â”‚  å·²ä¸Šä¼ å‘¨æœŸ: [ä¸‹æ‹‰åˆ—è¡¨æ˜¾ç¤ºæ‰€æœ‰å‘¨æœŸ]                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ“Š æ•°æ®å¯¹æ¯”åˆ†æ                                        â”‚ â”‚
â”‚  â”‚                                                       â”‚ â”‚
â”‚  â”‚  åŸºçº¿å‘¨æœŸ: [å¤šé€‰] 2025-09-01~09-07 âœ“                  â”‚ â”‚
â”‚  â”‚           â–¡ 2025-09-08~09-14                         â”‚ â”‚
â”‚  â”‚           â–¡ 2025-09-15~09-21                         â”‚ â”‚
â”‚  â”‚                                                       â”‚ â”‚
â”‚  â”‚  å¯¹æ¯”å‘¨æœŸ: [å•é€‰] â—‹ 2025-11-03~11-09                  â”‚ â”‚
â”‚  â”‚                  â— 2025-11-10~11-16                  â”‚ â”‚
â”‚  â”‚                                                       â”‚ â”‚
â”‚  â”‚  [ç”Ÿæˆåˆ†ææŠ¥å‘Š] [å¯¼å‡ºä¸ºPDF]                           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ“ˆ ä»ªè¡¨ç›˜ï¼ˆå®Œå…¨å¤ç”¨V1æ ·å¼ï¼‰                             â”‚ â”‚
â”‚  â”‚                                                       â”‚ â”‚
â”‚  â”‚  [KPIå¡ç‰‡1] [KPIå¡ç‰‡2] [KPIå¡ç‰‡3] [KPIå¡ç‰‡4]         â”‚ â”‚
â”‚  â”‚                                                       â”‚ â”‚
â”‚  â”‚  [ä¼šè®®ç±»å‹åˆ†å¸ƒ] [è¶‹åŠ¿å›¾] [åŸå§‹æ•°æ®è¡¨]                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 4. APIæ¥å£è®¾è®¡ï¼ˆæç®€ï¼‰

```python
# app/routes.py
from flask import Flask, render_template, request, jsonify
from app.file_manager import WeeklyDataManager
from app.analysis import analyze_data

app = Flask(__name__)
manager = WeeklyDataManager()

@app.route('/')
def index():
    """å•é¡µé¢åº”ç”¨"""
    weeks = manager.get_all_weeks()
    return render_template('index.html', weeks=weeks)

@app.route('/api/upload', methods=['POST'])
def upload():
    """ä¸Šä¼ CSVæ–‡ä»¶"""
    file = request.files['file']
    week_start = request.form['week_start']  # ä»å‰ç«¯è¾“å…¥
    week_end = request.form['week_end']

    week_info = manager.upload_csv(file, week_start, week_end)

    return jsonify({
        'success': True,
        'week_info': week_info
    })

@app.route('/api/weeks')
def get_weeks():
    """è·å–æ‰€æœ‰å‘¨æœŸ"""
    weeks = manager.get_all_weeks()
    return jsonify(weeks)

@app.route('/api/analyze', methods=['POST'])
def analyze():
    """ç”Ÿæˆåˆ†ææŠ¥å‘Š"""
    data = request.json
    baseline_weeks = data['baseline_weeks']  # ["2025-09-01_to_2025-09-07", ...]
    current_week = data['current_week']       # "2025-11-10_to_2025-11-16"

    # åŠ è½½æ•°æ®
    baseline_data = []
    for week_id in baseline_weeks:
        df = manager.get_week_data(week_id)
        if df is not None:
            baseline_data.append(df)

    current_data = manager.get_week_data(current_week)

    # è°ƒç”¨åˆ†ææ¨¡å—ï¼ˆå¤ç”¨V1ï¼‰
    result = analyze_data(baseline_data, current_data)

    return jsonify(result)

@app.route('/api/delete/<week_id>', methods=['DELETE'])
def delete_week(week_id):
    """åˆ é™¤å‘¨æ•°æ®"""
    success = manager.delete_week(week_id)
    return jsonify({'success': success})
```

---

### 5. å‰ç«¯äº¤äº’é€»è¾‘

```javascript
// app/static/js/upload.js

// æ–‡ä»¶ä¸Šä¼ 
async function uploadCSV(file, weekStart, weekEnd) {
    const formData = new FormData();
    formData.append('file', file);
    formData.append('week_start', weekStart);
    formData.append('week_end', weekEnd);

    const response = await fetch('/api/upload', {
        method: 'POST',
        body: formData
    });

    const result = await response.json();

    if (result.success) {
        alert('ä¸Šä¼ æˆåŠŸï¼');
        loadWeeksList();  // åˆ·æ–°å‘¨æœŸåˆ—è¡¨
    }
}

// åŠ è½½å‘¨æœŸåˆ—è¡¨
async function loadWeeksList() {
    const response = await fetch('/api/weeks');
    const weeks = await response.json();

    // æ›´æ–°åŸºçº¿å‘¨æœŸå¤šé€‰æ¡†
    const baselineContainer = document.getElementById('baseline-weeks');
    baselineContainer.innerHTML = weeks.map(w => `
        <label>
            <input type="checkbox" value="${w.id}">
            ${w.display_name} (${w.record_count}æ¡è®°å½•)
        </label>
    `).join('');

    // æ›´æ–°å¯¹æ¯”å‘¨æœŸå•é€‰æ¡†
    const currentContainer = document.getElementById('current-week');
    currentContainer.innerHTML = weeks.map(w => `
        <label>
            <input type="radio" name="current" value="${w.id}">
            ${w.display_name} (${w.record_count}æ¡è®°å½•)
        </label>
    `).join('');
}

// ç”Ÿæˆåˆ†ææŠ¥å‘Š
async function generateReport() {
    const baselineWeeks = Array.from(
        document.querySelectorAll('#baseline-weeks input:checked')
    ).map(el => el.value);

    const currentWeek = document.querySelector(
        'input[name="current"]:checked'
    )?.value;

    if (!baselineWeeks.length || !currentWeek) {
        alert('è¯·é€‰æ‹©åŸºçº¿å‘¨æœŸå’Œå¯¹æ¯”å‘¨æœŸ');
        return;
    }

    const response = await fetch('/api/analyze', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({
            baseline_weeks: baselineWeeks,
            current_week: currentWeek
        })
    });

    const result = await response.json();

    // æ¸²æŸ“ä»ªè¡¨ç›˜ï¼ˆå¤ç”¨V1çš„æ¸²æŸ“é€»è¾‘ï¼‰
    renderDashboard(result);
}

// æ¸²æŸ“ä»ªè¡¨ç›˜ï¼ˆå®Œå…¨å¤ç”¨V1ä»£ç ï¼‰
function renderDashboard(data) {
    // ç›´æ¥å¤ç”¨V1çš„full_dashboard_gen.pyä¸­çš„JavaScriptä»£ç 
    renderKPICards(data.kpi);
    renderOverviewTypeChart(data.meeting_types);
    renderRawDataTable(data.raw_data);
    // ... å…¶ä»–å›¾è¡¨
}
```

---

### 6. æ–‡ä»¶åè§£æåŠŸèƒ½

```python
# app/file_manager.py (è¡¥å……)

import re

def parse_filename(filename):
    """
    è‡ªåŠ¨è§£ææ–‡ä»¶åä¸­çš„å‘¨æœŸä¿¡æ¯
    æ”¯æŒæ ¼å¼:
    - "11.03-11.09ä¼šè®®è¯¦æƒ….csv" â†’ 2025-11-03 to 2025-11-09
    - "2025-11-03_to_2025-11-09.csv"
    - "11æœˆç¬¬1å‘¨ä¼šè®®è¯¦æƒ….csv" â†’ æç¤ºç”¨æˆ·æ‰‹åŠ¨è¾“å…¥
    """
    # æ¨¡å¼1: MM.DD-MM.DD
    pattern1 = r'(\d{1,2})\.(\d{1,2})-(\d{1,2})\.(\d{1,2})'
    match = re.search(pattern1, filename)
    if match:
        start_month, start_day, end_month, end_day = match.groups()
        current_year = datetime.now().year
        return {
            'start': f"{current_year}-{int(start_month):02d}-{int(start_day):02d}",
            'end': f"{current_year}-{int(end_month):02d}-{int(end_day):02d}",
            'auto_detected': True
        }

    # æ¨¡å¼2: YYYY-MM-DD_to_YYYY-MM-DD
    pattern2 = r'(\d{4}-\d{2}-\d{2})_to_(\d{4}-\d{2}-\d{2})'
    match = re.search(pattern2, filename)
    if match:
        return {
            'start': match.group(1),
            'end': match.group(2),
            'auto_detected': True
        }

    # æ— æ³•è‡ªåŠ¨è¯†åˆ«
    return {
        'start': None,
        'end': None,
        'auto_detected': False
    }
```

**å‰ç«¯ä½¿ç”¨**:
```javascript
// æ–‡ä»¶é€‰æ‹©åè‡ªåŠ¨è§£æ
fileInput.addEventListener('change', (e) => {
    const file = e.target.files[0];
    const parsed = parseFilename(file.name);

    if (parsed.auto_detected) {
        document.getElementById('week-start').value = parsed.start;
        document.getElementById('week-end').value = parsed.end;
        document.getElementById('hint').innerText = 'âœ… å·²è‡ªåŠ¨è¯†åˆ«å‘¨æœŸ';
    } else {
        document.getElementById('hint').innerText = 'âš ï¸ è¯·æ‰‹åŠ¨è¾“å…¥å‘¨æœŸ';
    }
});
```

---

### 7. é…ç½®æ–‡ä»¶

```yaml
# config.yaml
app:
  name: "ä¼šè®®æ”¹å–„æ•ˆæœè¯„ä¼°ç³»ç»Ÿ V2.0"
  version: "2.0.0"
  host: "127.0.0.1"
  port: 5000
  debug: true

data:
  storage_dir: "data/weekly_data"
  index_file: "data/weeks_index.json"
  max_file_size_mb: 10

analysis:
  baseline_definition: "manual"  # manualï¼ˆç”¨æˆ·æ‰‹åŠ¨é€‰æ‹©ï¼‰
  required_columns:
    - "user_name"
    - "æ—¥äººå‡çº¿ä¸Šä¼šè®®æ•°"
    - "æ—¥äººå‡çº¿ä¸Šä¼šè®®æ—¶é•¿(åˆ†é’Ÿ)"
    - "å³æ—¶ä¼šè®®"
    - "æ—¥ç¨‹ä¼šè®®"
    - "1v1é€šè¯æ•°"

ui:
  theme: "light"
  items_per_page: 20
  chart_colors:
    primary: "#4299e1"
    success: "#48bb78"
    warning: "#ed8936"
    danger: "#f56565"

backup:
  enabled: true
  auto_backup_days: 7  # æ¯7å¤©è‡ªåŠ¨å¤‡ä»½
  backup_dir: "backups"
```

---

## ğŸš€ å¯åŠ¨æ–¹å¼

**1. å®‰è£…ä¾èµ–**:
```bash
pip install -r requirements.txt
```

**2. å¯åŠ¨åº”ç”¨**:
```bash
python run.py
```

**3. æ‰“å¼€æµè§ˆå™¨**:
```
http://127.0.0.1:5000
```

**4. ä½¿ç”¨æµç¨‹**:
1. ç‚¹å‡»"é€‰æ‹©æ–‡ä»¶"ä¸Šä¼ CSVï¼ˆæˆ–æ‹–æ‹½ï¼‰
2. è‡ªåŠ¨è¯†åˆ«å‘¨æœŸï¼ˆæˆ–æ‰‹åŠ¨è¾“å…¥ï¼‰
3. ç‚¹å‡»"ä¸Šä¼ "
4. åœ¨ä¸‹æ–¹é€‰æ‹©åŸºçº¿å‘¨æœŸï¼ˆå¯å¤šé€‰ï¼‰
5. é€‰æ‹©å¯¹æ¯”å‘¨æœŸï¼ˆå•é€‰ï¼‰
6. ç‚¹å‡»"ç”Ÿæˆåˆ†ææŠ¥å‘Š"
7. æŸ¥çœ‹ä»ªè¡¨ç›˜ï¼ˆä¸V1å®Œå…¨ä¸€è‡´çš„æ ·å¼ï¼‰

---

## âœ… V1 åˆ° V2 è¿ç§»ç­–ç•¥

### è‡ªåŠ¨è¿ç§»è„šæœ¬

```python
# migrate_v1_to_v2.py
"""å°†V1çš„inputç›®å½•æ•°æ®è¿ç§»åˆ°V2çš„data/weekly_dataç»“æ„"""

import os
import shutil
from pathlib import Path
from app.file_manager import WeeklyDataManager, parse_filename

def migrate():
    manager = WeeklyDataManager()
    v1_input_dir = Path("../regular/input")  # V1çš„inputç›®å½•

    if not v1_input_dir.exists():
        print("V1æ•°æ®ç›®å½•ä¸å­˜åœ¨")
        return

    for csv_file in v1_input_dir.glob("*.csv"):
        print(f"å¤„ç†æ–‡ä»¶: {csv_file.name}")

        # è§£ææ–‡ä»¶å
        parsed = parse_filename(csv_file.name)

        if not parsed['auto_detected']:
            print(f"  âš ï¸  æ— æ³•è‡ªåŠ¨è¯†åˆ«å‘¨æœŸï¼Œè·³è¿‡: {csv_file.name}")
            continue

        # åˆ›å»ºå‘¨æœŸç›®å½•
        week_id = f"{parsed['start']}_to_{parsed['end']}"
        week_dir = Path(f"data/weekly_data/{week_id}")
        week_dir.mkdir(parents=True, exist_ok=True)

        # å¤åˆ¶CSV
        dest = week_dir / "meeting_data.csv"
        shutil.copy(csv_file, dest)

        print(f"  âœ… å·²è¿ç§»: {week_id}")

    print("\nè¿ç§»å®Œæˆï¼è¯·è¿è¡Œåº”ç”¨æŸ¥çœ‹æ•°æ®ã€‚")

if __name__ == '__main__':
    migrate()
```

---

## ğŸ“¦ å®Œæ•´æ–‡ä»¶æ¸…å•

### åç«¯æ–‡ä»¶
```
app/
  â”œâ”€â”€ __init__.py         (50è¡Œ)
  â”œâ”€â”€ routes.py           (100è¡Œ)
  â”œâ”€â”€ file_manager.py     (200è¡Œ)
  â””â”€â”€ analysis.py         (å¤ç”¨V1ï¼Œçº¦500è¡Œ)
```

### å‰ç«¯æ–‡ä»¶
```
app/templates/
  â”œâ”€â”€ base.html           (50è¡Œ)
  â””â”€â”€ index.html          (300è¡Œ)

app/static/
  â”œâ”€â”€ css/main.css        (500è¡Œï¼Œå¤ç”¨V1æ ·å¼)
  â”œâ”€â”€ js/upload.js        (150è¡Œ)
  â””â”€â”€ js/dashboard.js     (å¤ç”¨V1ï¼Œçº¦2000è¡Œ)
```

### é…ç½®æ–‡ä»¶
```
run.py                    (20è¡Œ)
config.yaml               (30è¡Œ)
requirements.txt          (5è¡Œ)
.gitignore                (å·²æœ‰)
README.md                 (200è¡Œ)
```

**æ€»ä»£ç é‡**: çº¦4000è¡Œï¼ˆå…¶ä¸­80%å¤ç”¨V1ä»£ç ï¼‰

---

## ğŸ¯ V2 vs V1 å¯¹æ¯”

| ç‰¹æ€§ | V1 | V2 |
|------|----|----|
| æ•°æ®è¾“å…¥ | æ‰‹åŠ¨æ”¾CSVåˆ°input/ | Webç•Œé¢ä¸Šä¼  |
| æ•°æ®å­˜å‚¨ | æ•£ä¹±çš„CSVæ–‡ä»¶ | æŒ‰å‘¨ç»„ç»‡çš„ç›®å½•ç»“æ„ |
| æ•°æ®ç®¡ç† | æ‰‹åŠ¨åˆ é™¤æ–‡ä»¶ | Webç•Œé¢ç®¡ç† |
| å‘¨æœŸé€‰æ‹© | ç¡¬ç¼–ç åœ¨ä»£ç ä¸­ | åŠ¨æ€é€‰æ‹©åŸºçº¿/å¯¹æ¯”å‘¨æœŸ |
| ç”Ÿæˆæ–¹å¼ | å‘½ä»¤è¡Œè¿è¡Œè„šæœ¬ | ç‚¹å‡»æŒ‰é’®å®æ—¶ç”Ÿæˆ |
| ç•Œé¢æ ·å¼ | é™æ€HTML | åŠ¨æ€Webåº”ç”¨ï¼ˆæ ·å¼ä¿æŒä¸€è‡´ï¼‰ |
| æ‰©å±•æ€§ | éœ€è¦æ”¹ä»£ç  | é…ç½®æ–‡ä»¶é©±åŠ¨ |
| ç‰ˆæœ¬æ§åˆ¶ | æ‰‹åŠ¨Git | è‡ªåŠ¨Gitæäº¤ï¼ˆå¯é€‰ï¼‰ |

---

## âš¡ å…³é”®ä¼˜åŠ¿

1. **æç®€æ¶æ„**
   - âœ… æ— æ•°æ®åº“ï¼Œçº¯æ–‡ä»¶ç³»ç»Ÿ
   - âœ… å•ä¸ªJSONæ–‡ä»¶ç®¡ç†å…ƒæ•°æ®
   - âœ… ä»£ç æ€»é‡å°‘ï¼Œæ˜“äºç»´æŠ¤

2. **ç”¨æˆ·å‹å¥½**
   - âœ… Webç•Œé¢æ“ä½œï¼Œæ— éœ€å‘½ä»¤è¡Œ
   - âœ… è‡ªåŠ¨è¯†åˆ«æ–‡ä»¶åä¸­çš„å‘¨æœŸ
   - âœ… å¯è§†åŒ–é€‰æ‹©åŸºçº¿å’Œå¯¹æ¯”å‘¨æœŸ

3. **æ•°æ®å®‰å…¨**
   - âœ… åŸå§‹CSVå®Œæ•´ä¿ç•™
   - âœ… æŒ‰å‘¨ç‹¬ç«‹å­˜å‚¨ï¼Œè¯¯åˆ å½±å“å°
   - âœ… Gitç‰ˆæœ¬æ§åˆ¶ï¼Œå¯éšæ—¶å›æ»š

4. **é«˜åº¦å¤ç”¨**
   - âœ… 80%ä»£ç å¤ç”¨V1
   - âœ… ç•Œé¢æ ·å¼å®Œå…¨ä¸€è‡´
   - âœ… å›¾è¡¨æ¸²æŸ“é€»è¾‘ä¸å˜

---

## ğŸ“‹ ç¡®è®¤æ¸…å•

åœ¨ç”Ÿæˆä»£ç å‰ï¼Œè¯·ç¡®è®¤ï¼š

1. **æŠ€æœ¯æ ˆç¡®è®¤**
   - [x] Flask + æ–‡ä»¶ç³»ç»Ÿï¼ˆæ— æ•°æ®åº“ï¼‰
   - [x] å•é¡µé¢åº”ç”¨
   - [x] å¤ç”¨V1æ ·å¼å’Œåˆ†æé€»è¾‘

2. **åŠŸèƒ½èŒƒå›´ç¡®è®¤**
   - [x] ä¸Šä¼ CSVï¼ˆWebç•Œé¢ï¼‰
   - [x] è‡ªåŠ¨è¯†åˆ«å‘¨æœŸï¼ˆæ”¯æŒæ‰‹åŠ¨è¾“å…¥ï¼‰
   - [x] å¤šé€‰åŸºçº¿å‘¨æœŸ
   - [x] å•é€‰å¯¹æ¯”å‘¨æœŸ
   - [x] å®æ—¶ç”Ÿæˆä»ªè¡¨ç›˜
   - [x] æ•°æ®ç®¡ç†ï¼ˆæŸ¥çœ‹ã€åˆ é™¤ï¼‰
   - [ ] å¯¼å‡ºPDFï¼ˆV2.1å†åšï¼‰
   - [ ] å¤šå‘¨è¶‹åŠ¿å›¾ï¼ˆV2.1å†åšï¼‰

3. **è¿ç§»ç­–ç•¥ç¡®è®¤**
   - [x] æä¾›V1åˆ°V2çš„è‡ªåŠ¨è¿ç§»è„šæœ¬
   - [x] ä¿ç•™V1é¡¹ç›®ä¸åŠ¨ï¼ŒV2ç‹¬ç«‹ç›®å½•

4. **éƒ¨ç½²æ–¹å¼ç¡®è®¤**
   - [x] çº¯æœ¬åœ°è¿è¡Œï¼ˆ127.0.0.1:5000ï¼‰
   - [x] æ— éœ€é¢å¤–æœåŠ¡å™¨

---

## ğŸ¬ ä¸‹ä¸€æ­¥

**è¯·ç¡®è®¤ä»¥ä¸‹é—®é¢˜**ï¼š

1. **é¡¹ç›®ä½ç½®**ï¼š
   - A: åœ¨`/Users/admin/Desktop/meeting-analysis-v2/`åˆ›å»ºæ–°é¡¹ç›®ï¼ˆæ¨èï¼‰
   - B: åœ¨å½“å‰`regular/`ç›®å½•ä¸‹åˆ›å»º`v2/`å­ç›®å½•

2. **V1æ•°æ®è¿ç§»**ï¼š
   - A: è‡ªåŠ¨è¿è¡Œè¿ç§»è„šæœ¬ï¼ˆæ¨èï¼‰
   - B: æ‰‹åŠ¨è¿ç§»

3. **æ–‡ä»¶åè§£æè§„åˆ™**ï¼š
   - A: æ”¯æŒ"11.03-11.09ä¼šè®®è¯¦æƒ….csv"æ ¼å¼ï¼ˆæ¨èï¼‰
   - B: æ”¯æŒ"2025-11-03_to_2025-11-09.csv"æ ¼å¼
   - C: ä¸¤ç§éƒ½æ”¯æŒï¼ˆæ¨èï¼‰

4. **æ˜¯å¦ç«‹å³ç”Ÿæˆé¡¹ç›®**ï¼š
   - A: æ˜¯ï¼Œå¼€å§‹ç”Ÿæˆå®Œæ•´ä»£ç 
   - B: å¦ï¼Œæˆ‘è¿˜æœ‰å…¶ä»–é—®é¢˜

---

**è¯·å›å¤ä½ çš„é€‰æ‹©ï¼ˆå¯ä»¥ç›´æ¥è¯´"1-A, 2-A, 3-C, 4-A"ï¼‰ï¼Œæˆ‘ä¼šç«‹å³å¼€å§‹ç”ŸæˆV2é¡¹ç›®ï¼** ğŸš€
