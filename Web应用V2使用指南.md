# 📊 会议改善效果评估系统 - Web应用 V2 使用指南

## 🎯 版本说明

**版本**: V2.0
**发布日期**: 2025-11-23
**主要特性**: 完整集成数据分析功能，支持自定义周期选择

---

## 🚀 快速开始

### 启动应用

```bash
# 方式1: 使用专用脚本（推荐）
python3 -m streamlit run app_v2.py --server.port 8502

# 方式2: 环境变量启动
STREAMLIT_SERVER_HEADLESS=true python3 -m streamlit run app_v2.py --server.port 8502 --server.headless true --browser.gatherUsageStats false

# 访问地址
http://localhost:8502
```

---

## 📋 功能模块

### 1. 📁 数据管理

这是使用系统的第一步，也是最重要的一步。

#### 功能特性

1. **上传CSV文件**
   - 支持拖拽上传
   - 支持多文件同时上传
   - 自动保存到 `input/` 目录

2. **文件管理**
   - 查看已上传的文件列表
   - 显示文件大小
   - 删除不需要的文件

3. **周期选择** ⭐ 核心功能
   - **基线期选择**: 选择措施实施前的数据（如9月、10月）
   - **当前期选择**: 选择措施实施后的数据（如11月各周）
   - 智能排除: 已选为基线期的文件不会出现在当前期列表中
   - 一键加载: 点击"🚀 加载数据并开始分析"按钮

#### 使用步骤

```
步骤1: 上传CSV文件
  ↓
步骤2: 选择基线期文件（可多选）
  ↓
步骤3: 选择当前期文件（可多选）
  ↓
步骤4: 点击"加载数据并开始分析"
  ↓
步骤5: 切换到其他页面查看分析结果
```

#### 💡 提示

- 基线期通常选择：9月会议详情.csv、10月会议详情.csv
- 当前期通常选择：11.03-11.09会议详情.csv、11.10-11.16会议详情.csv 等
- 可以随时重新选择周期并重新加载数据

---

### 2. 📊 概览

提供整体数据的快速概览和趋势分析。

#### 显示内容

1. **核心KPI卡片**（3个）
   - 日人均会议数
     - 当前期平均值
     - 基线期平均值
     - 变化百分比
   - 日人均会议时长
     - 当前期平均值（分钟）
     - 基线期平均值（分钟）
     - 变化百分比
   - 即时会议占比
     - 当前期占比
     - 基线期占比
     - 变化百分点

2. **趋势分析图表**
   - 各周期的会议数变化趋势
   - 交互式折线图（可悬停查看详情）

3. **会议类型分布**
   - 基线期饼图：即时会议、日程会议、1v1通话占比
   - 当前期饼图：即时会议、日程会议、1v1通话占比
   - 并排对比，直观看出变化

#### 使用场景

- 快速了解整体改善效果
- 向管理层汇报时的首页展示
- 定期检查KPI达标情况

---

### 3. 📄 原始数据

查看和筛选所有加载的原始数据。

#### 功能特性

1. **多维度筛选**
   - 按周期筛选：可多选不同的周期
   - 按类型筛选：基线期/当前期
   - 按用户搜索：输入用户名关键字

2. **数据展示**
   - 交互式数据表格
   - 支持排序
   - 支持滚动查看

3. **数据导出**
   - 📥 下载筛选后的数据为CSV格式
   - 方便进一步分析或存档

#### 使用场景

- 验证数据准确性
- 查找特定用户的数据
- 导出数据进行离线分析
- 审计和追溯

---

### 4. 📈 分析结果

深度分析和统计结果展示。

#### 功能模块

1. **🏆 Top10 高频会议用户**
   - 当前期会议数最多的10个用户
   - 柱状图可视化
   - 详细数据表格

2. **📊 用户分层统计**
   - 🔴 高频用户（≥5次/天）
     - 人数统计
     - 平均会议数
   - 🟡 中频用户（2-5次/天）
     - 人数统计
     - 平均会议数
   - 🟢 低频用户（<2次/天）
     - 人数统计
     - 平均会议数

3. **👔 主责人员统计**
   - 显示已配置的主责人员数据
   - 平均会议数和平均时长
   - 如未配置会提示前往配置页面

#### 使用场景

- 识别会议负担较重的用户
- 分析不同层级用户的会议模式
- 关注主责人员的工作负担

---

### 5. 👥 人员详情

查看单个用户的详细分析。

#### 功能特性

1. **用户选择**
   - 下拉框选择任意用户
   - 自动加载该用户的所有数据

2. **统计卡片**（4个）
   - 数据周期数：该用户在多少个周期中有数据
   - 平均会议数/天
   - 平均时长/天（分钟）
   - 即时会议占比

3. **历史趋势图**
   - 该用户各周期的会议数变化
   - 交互式折线图

4. **详细数据表**
   - 该用户在所有周期的完整数据
   - 可查看各项具体指标

#### 使用场景

- 了解特定用户的会议习惯
- 跟踪个人改善情况
- 一对一辅导时的数据支持

---

### 6. ⚙️ 配置

系统配置和主责人员管理。

#### 功能特性

1. **主责人员管理**
   - 查看已配置的主责人员列表
   - 显示姓名和备注
   - 删除不需要的人员

2. **批量添加主责人员**
   - 从已加载的数据中选择用户
   - 支持多选
   - 统一添加备注

#### 使用步骤

```
步骤1: 在"数据管理"页面加载数据
  ↓
步骤2: 切换到"配置"页面
  ↓
步骤3: 从用户列表中多选主责人员
  ↓
步骤4: 填写备注（可选）
  ↓
步骤5: 点击"添加"按钮
```

---

## 🎨 界面导航

### 侧边栏状态指示

应用会根据数据加载状态动态显示可用页面：

**数据未加载时**:
- 📁 数据管理
- ⚙️ 配置

**数据已加载后**:
- 📁 数据管理
- 📊 概览
- 📄 原始数据
- 📈 分析结果
- 👥 人员详情
- ⚙️ 配置

### 数据状态显示

侧边栏底部实时显示：
- ✅ 数据已加载 / ⚠️ 请先加载数据
- 📦 总记录数
- 📅 基线期记录数
- 📅 当前期记录数

---

## 📊 数据要求

### CSV文件格式

#### 必需字段

| 字段名 | 类型 | 说明 |
|--------|------|------|
| `user_name` | 文本 | 用户名 |
| `日人均线上会议数-即时+日程` | 浮点 | 日均会议数（不含1v1） |
| `日人均线上会议时长(分钟)-即时+日程` | 浮点 | 日均时长（不含1v1） |
| `即时会议` | 整数 | 即时会议数量 |
| `日程会议` | 整数 | 日程会议数量 |
| `即时+日程会议` | 整数 | 总会议数 |
| `1v1通话数` | 整数 | 1v1通话次数 |

#### 文件命名建议

- 月度数据: `9月会议详情.csv`、`10月会议详情.csv`
- 周度数据: `11.03-11.09会议详情.csv`、`11.10-11.16会议详情.csv`

---

## 🔄 典型使用流程

### 首次使用

```
1. 启动应用
   ↓
2. 上传CSV文件（6个文件）
   ↓
3. 选择基线期（9月、10月）
   ↓
4. 选择当前期（11月各周）
   ↓
5. 加载数据
   ↓
6. 查看概览页面（快速了解改善效果）
   ↓
7. 查看分析结果（深入分析）
   ↓
8. 配置主责人员
   ↓
9. 重新查看分析结果（查看主责人员统计）
```

### 日常使用

```
1. 启动应用
   ↓
2. 上传新的周度数据
   ↓
3. 重新选择当前期（包含新数据）
   ↓
4. 重新加载
   ↓
5. 查看最新的分析结果
```

---

## 💡 使用技巧

### 1. 周期选择策略

**固定基线期**:
- 始终选择9月和10月作为基线期
- 这样可以保持对比的一致性

**滚动当前期**:
- 每周添加新数据后，更新当前期选择
- 可以只选择最近4周，保持对比的时效性

### 2. 主责人员配置

**建议配置**:
- 项目负责人（3-5人）
- 团队Leader（3-5人）
- 核心技术骨干（5-10人）

**不建议配置**:
- 所有人都配置为主责人员
- 临时参与者

### 3. 数据筛选技巧

**快速定位**:
- 在原始数据页面使用用户搜索
- 在人员详情页面查看个人趋势

**对比分析**:
- 在概览页面看整体趋势
- 在分析结果页面看Top10变化

---

## ⚠️ 注意事项

### 数据质量

1. **确保CSV文件编码为UTF-8**
2. **检查必需字段是否完整**
3. **数值字段不能包含非数字字符**

### 性能优化

1. **一次不要加载过多文件**（建议≤10个）
2. **大数据集筛选时可能需要等待几秒**
3. **如果卡顿，尝试刷新页面**

### 数据安全

1. **数据仅存储在本地**
2. **不会上传到任何外部服务器**
3. **删除文件会永久删除，无法恢复**

---

## 🆚 V1 vs V2 对比

| 功能 | V1 | V2 |
|------|----|----|
| 数据上传 | ✅ | ✅ |
| 周期选择 | ❌ 硬编码 | ✅ 用户自定义 |
| 概览页面 | ❌ 仅HTML | ✅ 集成到Web |
| 原始数据 | ❌ 仅HTML | ✅ 集成到Web |
| 分析结果 | ❌ 仅HTML | ✅ 集成到Web |
| 人员详情 | ❌ 仅HTML | ✅ 集成到Web |
| 主责人员配置 | ✅ | ✅ |
| 实时交互 | ❌ | ✅ |
| 数据筛选 | ❌ | ✅ |
| 图表交互 | ❌ | ✅ Plotly |

---

## 🐛 常见问题

### Q: 页面打不开？

**A**: 检查以下几点：
1. 确认端口8502未被占用
2. 确认streamlit已正确安装
3. 查看终端错误信息

### Q: 数据加载失败？

**A**: 检查：
1. CSV文件格式是否正确
2. 必需字段是否完整
3. 是否选择了基线期和当前期

### Q: 图表不显示？

**A**: 可能原因：
1. 数据为空或筛选后无数据
2. 浏览器兼容性问题（建议使用Chrome）
3. 刷新页面重试

### Q: 主责人员统计为空？

**A**: 需要：
1. 先在"配置"页面添加主责人员
2. 确保主责人员姓名与CSV中完全一致
3. 确保主责人员在当前期数据中存在

---

## 📞 技术支持

如有问题，请检查：
1. [CHANGELOG.md](CHANGELOG.md) - 查看版本更新历史
2. [功能更新记录_2025-11-23.md](功能更新记录_2025-11-23.md) - 查看最新功能
3. 终端输出的错误信息

---

## 🎉 开始使用

现在您可以：
1. 访问 http://localhost:8502
2. 按照"首次使用"流程开始分析
3. 体验完整的数据分析功能

**祝使用愉快！** 📊✨
